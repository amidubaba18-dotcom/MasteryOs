<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mastery OS | Learning Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'JetBrains Mono', monospace; background-color: #050505; color: #a1a1aa; }
        .glass { background: rgba(15, 15, 15, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.05); }
        .emerald-glow { box-shadow: 0 0 20px rgba(16, 185, 129, 0.1); }
        input, select, textarea { transition: all 0.2s ease; }
        input:focus { border-color: #10b981 !important; box-shadow: 0 0 0 2px rgba(16,185,129,0.1); }
        .milestone-card { transition: transform 0.2s ease, border-color 0.2s ease; }
        .milestone-card:hover { transform: translateY(-2px); border-color: #27272a; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: #27272a; border-radius: 10px; }
    </style>
</head>
<body class="min-h-screen pb-20">

    <div class="sticky top-0 z-[60] glass border-b border-zinc-800/50">
        <div class="max-w-6xl mx-auto px-6 py-4 flex items-center gap-6">
            <div class="hidden md:block">
                <span class="text-[10px] font-black text-emerald-500 tracking-[0.2em]">MASTERY_LEVEL</span>
                <div class="text-xl font-bold text-white" id="global-percent-text">0%</div>
            </div>
            <div class="flex-grow">
                <div class="flex justify-between text-[10px] mb-1 font-bold">
                    <span id="progress-status">SYSTEM_INITIALIZING...</span>
                    <span id="nodes-count">NODES: 00</span>
                </div>
                <div class="h-1.5 w-full bg-zinc-900 rounded-full overflow-hidden">
                    <div id="global-progress-fill" class="h-full bg-emerald-500 transition-all duration-700 shadow-[0_0_10px_#10b981]" style="width: 0%"></div>
                </div>
            </div>
            <div class="flex gap-2">
                <button onclick="document.getElementById('import-file').click()" class="p-2 hover:text-white transition-colors" title="Import Backup"><i data-lucide="upload-cloud" size="18"></i></button>
                <input type="file" id="import-file" class="hidden" onchange="importData(event)">
                <button onclick="exportData()" class="p-2 hover:text-white transition-colors" title="Export Data"><i data-lucide="download-cloud" size="18"></i></button>
            </div>
        </div>
    </div>

    <div class="max-w-6xl mx-auto px-6 pt-12">
        
        <header class="mb-12 flex flex-col md:flex-row justify-between items-start gap-8">
            <div class="space-y-2">
                <h1 class="text-5xl font-black text-white tracking-tighter uppercase italic">Stack_Journey</h1>
                <p class="text-zinc-500 border-l-2 border-emerald-500 pl-4">Predicting technical proficiency through iterative tracking.</p>
            </div>
            <div class="flex flex-col sm:flex-row gap-4 w-full md:w-auto">
                <div class="relative flex-grow">
                    <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 text-zinc-600" size="16"></i>
                    <input type="text" id="search-input" oninput="render()" placeholder="SEARCH_NODES..." class="bg-zinc-900 border border-zinc-800 rounded-xl py-3 pl-10 pr-4 text-xs w-full focus:outline-none">
                </div>
                <button onclick="toggleForm()" class="bg-emerald-500 hover:bg-emerald-400 text-black font-black px-8 py-3 rounded-xl transition-all flex items-center justify-center gap-2">
                    <i data-lucide="plus" size="18"></i> ADD_NODE
                </button>
            </div>
        </header>

        <div id="stats-container" class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-12">
            </div>

        <div class="flex items-center gap-4 mb-6 overflow-x-auto pb-2 no-scrollbar">
            <button onclick="setFilter('all')" data-filter="all" class="filter-btn active px-4 py-2 rounded-lg text-[10px] font-black border border-zinc-800 bg-zinc-900 text-zinc-400">ALL</button>
            <button onclick="setFilter('planning')" data-filter="planning" class="filter-btn px-4 py-2 rounded-lg text-[10px] font-black border border-zinc-800 hover:bg-zinc-900 transition-colors">PLANNING</button>
            <button onclick="setFilter('ongoing')" data-filter="ongoing" class="filter-btn px-4 py-2 rounded-lg text-[10px] font-black border border-zinc-800 hover:bg-zinc-900 transition-colors text-amber-500">LEARNING</button>
            <button onclick="setFilter('completed')" data-filter="completed" class="filter-btn px-4 py-2 rounded-lg text-[10px] font-black border border-zinc-800 hover:bg-zinc-900 transition-colors text-emerald-500">MASTERED</button>
        </div>

        <div id="journey-list" class="space-y-4"></div>
        <div id="empty-state" class="hidden py-40 text-center border border-zinc-900 rounded-3xl bg-zinc-950/50">
            <i data-lucide="terminal" class="mx-auto mb-4 text-zinc-800" size="48"></i>
            <p class="text-xs uppercase tracking-widest font-bold">Waiting for input signals...</p>
        </div>

    </div>

    <div id="form-overlay" class="hidden fixed inset-0 z-[100] glass flex items-center justify-center p-4 overflow-y-auto">
        <div class="bg-black border border-zinc-800 w-full max-w-2xl rounded-3xl p-8 my-auto shadow-2xl emerald-glow">
            <div class="flex justify-between items-center mb-8">
                <h2 id="form-title" class="text-2xl font-black text-white italic underline decoration-emerald-500">CREATE_NODE</h2>
                <button onclick="resetForm()" class="text-zinc-500 hover:text-white"><i data-lucide="x"></i></button>
            </div>
            <form id="journey-form" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <input type="hidden" id="edit-id">
                
                <div class="space-y-2 md:col-span-2">
                    <label class="text-[10px] font-black uppercase text-zinc-500">Milestone Title</label>
                    <input type="text" id="title" required class="w-full bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-sm text-white focus:outline-none" placeholder="e.g. Distributed Systems">
                </div>

                <div class="space-y-2">
                    <label class="text-[10px] font-black uppercase text-zinc-500">Status</label>
                    <select id="status" class="w-full bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-sm text-white focus:outline-none appearance-none">
                        <option value="planning">PLANNING</option>
                        <option value="ongoing">LEARNING</option>
                        <option value="completed">MASTERED</option>
                    </select>
                </div>

                <div class="space-y-2">
                    <label class="text-[10px] font-black uppercase text-zinc-500">Priority</label>
                    <select id="priority" class="w-full bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-sm text-white focus:outline-none appearance-none">
                        <option value="low">LOW_PRIORITY</option>
                        <option value="med" selected>MEDIUM_PRIORITY</option>
                        <option value="high">CRITICAL_PATH</option>
                    </select>
                </div>

                <div class="space-y-2">
                    <label class="text-[10px] font-black uppercase text-zinc-500">Start_Date</label>
                    <input type="date" id="startDate" class="w-full bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-sm text-white focus:outline-none">
                </div>

                <div class="space-y-2">
                    <label class="text-[10px] font-black uppercase text-zinc-500">Target_Completion</label>
                    <input type="date" id="endDate" class="w-full bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-sm text-white focus:outline-none">
                </div>

                <div class="space-y-2 md:col-span-2">
                    <label class="text-[10px] font-black uppercase text-zinc-500">Stack / Tools</label>
                    <input type="text" id="destinations" class="w-full bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-sm text-white focus:outline-none" placeholder="Go, Kubernetes, Docker...">
                </div>

                <div class="space-y-2 md:col-span-2">
                    <label class="text-[10px] font-black uppercase text-zinc-500">Resource Links (One per line)</label>
                    <textarea id="links" rows="2" class="w-full bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-sm text-white focus:outline-none" placeholder="https://docs.example.com"></textarea>
                </div>

                <div class="space-y-2 md:col-span-2">
                    <label class="text-[10px] font-black uppercase text-zinc-500">Mission Notes</label>
                    <textarea id="notes" rows="3" class="w-full bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-sm text-white focus:outline-none"></textarea>
                </div>

                <div class="md:col-span-2 pt-4">
                    <button type="submit" class="w-full bg-emerald-500 hover:bg-emerald-400 text-black font-black py-4 rounded-xl transition-all uppercase tracking-widest">Update_System</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let journeys = JSON.parse(localStorage.getItem('mastery_os_v3')) || [];
        let currentFilter = 'all';

        const listEl = document.getElementById('journey-list');
        const formOverlay = document.getElementById('form-overlay');
        const form = document.getElementById('journey-form');

        function toggleForm() { formOverlay.classList.toggle('hidden'); }
        function resetForm() { form.reset(); document.getElementById('edit-id').value = ''; toggleForm(); }

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const editId = document.getElementById('edit-id').value;
            const data = {
                title: document.getElementById('title').value,
                status: document.getElementById('status').value,
                priority: document.getElementById('priority').value,
                startDate: document.getElementById('startDate').value,
                endDate: document.getElementById('endDate').value,
                destinations: document.getElementById('destinations').value,
                links: document.getElementById('links').value,
                notes: document.getElementById('notes').value
            };

            if (editId) {
                const idx = journeys.findIndex(j => j.id == editId);
                journeys[idx] = { ...journeys[idx], ...data };
            } else {
                journeys.push({ id: Date.now(), ...data });
            }

            saveAndRender();
            resetForm();
        });

        function saveAndRender() {
            localStorage.setItem('mastery_os_v3', JSON.stringify(journeys));
            render();
        }

        function deleteNode(id) {
            if(confirm('Wipe node data permanently?')) {
                journeys = journeys.filter(j => j.id !== id);
                saveAndRender();
            }
        }

        function editNode(id) {
            const j = journeys.find(item => item.id === id);
            document.getElementById('edit-id').value = j.id;
            document.getElementById('title').value = j.title;
            document.getElementById('status').value = j.status;
            document.getElementById('priority').value = j.priority;
            document.getElementById('startDate').value = j.startDate;
            document.getElementById('endDate').value = j.endDate;
            document.getElementById('destinations').value = j.destinations;
            document.getElementById('links').value = j.links || '';
            document.getElementById('notes').value = j.notes;
            document.getElementById('form-title').innerText = 'EDIT_NODE_' + j.id;
            toggleForm();
        }

        function setFilter(f) {
            currentFilter = f;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('bg-zinc-900', btn.dataset.filter === f);
                btn.classList.toggle('text-white', btn.dataset.filter === f);
                btn.classList.toggle('border-emerald-500', btn.dataset.filter === f);
            });
            render();
        }

        function exportData() {
            const blob = new Blob([JSON.stringify(journeys)], {type: "application/json"});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `mastery_os_backup_${new Date().toISOString().slice(0,10)}.json`;
            a.click();
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);
                    if (Array.isArray(data)) {
                        journeys = data;
                        saveAndRender();
                        alert('System restored successfully.');
                    }
                } catch (err) { alert('Invalid backup file.'); }
            };
            reader.readAsText(file);
        }

        function render() {
            const searchQuery = document.getElementById('search-input').value.toLowerCase();
            listEl.innerHTML = '';
            
            const filtered = journeys.filter(j => {
                const matchesFilter = currentFilter === 'all' || j.status === currentFilter;
                const matchesSearch = j.title.toLowerCase().includes(searchQuery) || j.destinations.toLowerCase().includes(searchQuery);
                return matchesFilter && matchesSearch;
            });

            // Global HUD Updates
            const total = journeys.length;
            const completed = journeys.filter(j => j.status === 'completed').length;
            const percent = total ? Math.round((completed / total) * 100) : 0;
            
            document.getElementById('global-progress-fill').style.width = percent + '%';
            document.getElementById('global-percent-text').innerText = percent + '%';
            document.getElementById('nodes-count').innerText = `NODES: ${total.toString().padStart(2, '0')}`;
            document.getElementById('progress-status').innerText = percent === 100 ? 'ALL_TASKS_COMPLETE' : 'SYSTEM_ACTIVE';

            // Stats Grid Injection
            document.getElementById('stats-container').innerHTML = `
                <div class="bg-zinc-900/40 border border-zinc-800 p-6 rounded-2xl">
                    <div class="text-xs font-black mb-1 opacity-40">MASTERED</div>
                    <div class="text-2xl font-bold text-emerald-500">${completed}</div>
                </div>
                <div class="bg-zinc-900/40 border border-zinc-800 p-6 rounded-2xl">
                    <div class="text-xs font-black mb-1 opacity-40">LEARNING</div>
                    <div class="text-2xl font-bold text-amber-500">${journeys.filter(j => j.status === 'ongoing').length}</div>
                </div>
                <div class="bg-zinc-900/40 border border-zinc-800 p-6 rounded-2xl">
                    <div class="text-xs font-black mb-1 opacity-40">CRITICAL</div>
                    <div class="text-2xl font-bold text-red-500">${journeys.filter(j => j.priority === 'high' && j.status !== 'completed').length}</div>
                </div>
                <div class="bg-zinc-900/40 border border-zinc-800 p-6 rounded-2xl">
                    <div class="text-xs font-black mb-1 opacity-40">QUEUE</div>
                    <div class="text-2xl font-bold text-blue-500">${journeys.filter(j => j.status === 'planning').length}</div>
                </div>
            `;

            if (!filtered.length) {
                document.getElementById('empty-state').classList.remove('hidden');
            } else {
                document.getElementById('empty-state').classList.add('hidden');
                filtered.sort((a,b) => b.id - a.id).forEach(j => {
                    const card = document.createElement('div');
                    const prioColor = j.priority === 'high' ? 'text-red-500' : j.priority === 'med' ? 'text-amber-500' : 'text-blue-500';
                    const isDone = j.status === 'completed';

                    card.className = `milestone-card glass p-6 rounded-2xl flex flex-col md:flex-row gap-6 relative overflow-hidden ${isDone ? 'opacity-60 border-emerald-900/20' : ''}`;
                    
                    card.innerHTML = `
                        <div class="flex-grow">
                            <div class="flex items-center gap-3 mb-4">
                                <span class="text-[10px] font-black uppercase ${prioColor}">${j.priority}_PRIO</span>
                                <h3 class="text-xl font-bold text-white uppercase italic">${j.title}</h3>
                            </div>
                            <div class="flex flex-wrap gap-x-6 gap-y-2 mb-6 text-[10px] font-bold uppercase tracking-widest text-zinc-500">
                                <span class="flex items-center gap-2"><i data-lucide="calendar" size="12"></i> ${j.startDate || '??'} > ${j.endDate || '??'}</span>
                                <span class="flex items-center gap-2 text-zinc-300"><i data-lucide="cpu" size="12"></i> ${j.destinations || 'GENERIC_STACK'}</span>
                            </div>
                            
                            ${j.links ? `
                                <div class="flex gap-2 mb-4 overflow-x-auto no-scrollbar">
                                    ${j.links.split('\n').filter(l => l.trim()).map(link => `
                                        <a href="${link}" target="_blank" class="px-3 py-1 bg-zinc-800 hover:bg-zinc-700 rounded-md text-[9px] text-zinc-300 flex items-center gap-2 transition-colors">
                                            <i data-lucide="external-link" size="10"></i> ${new URL(link).hostname}
                                        </a>
                                    `).join('')}
                                </div>
                            ` : ''}

                            ${j.notes ? `<p class="text-xs leading-relaxed text-zinc-500 border-l border-zinc-800 pl-4">${j.notes}</p>` : ''}
                        </div>
                        <div class="flex md:flex-col justify-end gap-2 border-t md:border-t-0 md:border-l border-zinc-800 pt-4 md:pt-0 md:pl-6">
                            <button onclick="editNode(${j.id})" class="p-3 hover:bg-zinc-800 rounded-xl text-zinc-400 hover:text-emerald-500 transition-all"><i data-lucide="terminal" size="18"></i></button>
                            <button onclick="deleteNode(${j.id})" class="p-3 hover:bg-zinc-800 rounded-xl text-zinc-400 hover:text-red-500 transition-all"><i data-lucide="trash-2" size="18"></i></button>
                        </div>
                    `;
                    listEl.appendChild(card);
                });
            }
            lucide.createIcons();
        }

        render();
    </script>
</body>
</html>